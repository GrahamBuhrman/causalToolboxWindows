c((1+x)/2, (1+x)/2,(1+x)/2,
0, 0)
}
vx(.5)
vy(.5)
sum(vx(.5)^2)
sum(vy(.5)^2)
sum(x^2)
sum(y^2)
sum(vx(xx)^2)
xx <- .5
sum(vx(xx)^2)
sum(vy(xx)^2)
var(vx(xx))
var(vy(xx))
xx <- .6
sum(vx(xx)^2)
sum(vy(xx)^2)
var(vx(xx))
var(vy(xx))
?randomForest
?randomforest
library(randomForest)
?randomForest
set.seed(112345123)
ntest = 1000
ntrain = 100
d = 10
# ntest, ntrain training and test size
# d amount of relevant features
# projected on. SW <- 1:3, Stau <- c(2, 4:6), Sm <- c(3, 4, 7:9)
n <- ntest + ntrain
if(d < 10) stop("d must be bigger or equal to 9")
X <- as.data.frame(matrix(runif(n * d, min = 0, max = 100), nrow = n, ncol = d))
SW <- 1:3
Stau <- c(2, 4:6)
Sm <- c(3, 4, 7:9)
W <- rbinom(n = n, size = 1, apply(X[,SW]/100, 1, mean))
Y <- W * (apply(X[ ,Stau], 1, mean)) + apply(X[ ,  Sm], 1, mean) + rnorm(n)
# This is using the TRF implementation, it cannot specify different splitting
# criteria for different
# trf <- T_RF(feat = X[1:ntrain, Sproj],
#             tr = W[1:ntrain],
#             yobs = Y[1:ntrain], mtry = 1)
# estimated <- EstimateCate(trf, X[(ntrain+1) : n, Sproj])
Y_train <- Y[1:ntrain]
W_train <- W[1:ntrain]
X_train <- X[1:ntrain, ]
sample(c(1,2,34,4))
sample(c(1,2,34,4))
sample(c(1,2,34,4))
sample(c(1,2))
sample(c(1,2))
sample(c(1,2))
sample(c(2))
sample(c(2))
sample(c(2))
sample(c(2))
?sample
# Explore 1
# read data sets:
setwd("~/Google Drive/Documents/DatathonData/")
library(dplyr)
library(reshape)
library(ggplot2)
load("rs.dta") #"ridership"
rs
rs[1,1]
rs[1:10,1]
rs[1:10,1:7]
dims(rs)
dim(rs)
rs[1:100,1:7]
rs[1:100,1:7] %>% as.data.frame()
rs[1:1000,1:7] %>% as.data.frame()
rs[1:10,1:7] %>% as.data.frame()
real_estate
real_estate <- read.csv("Datasets/real_estate.csv") %>% tbl_df()
real_estate
demos
demos <- read.csv("Datasets/demographics.csv") %>% tbl_df()
stations <- read.csv("Datasets/stations.csv") %>% tbl_df()
real_estate
demos
setwd("~/Google Drive/Documents/DatathonData/")
stations <- read.csv("Datasets/stations.csv") %>% tbl_df()
fares <- read.csv("Datasets/fares.csv") %>% tbl_df()
demos <- read.csv("Datasets/demographics.csv") %>% tbl_df()
real_estate <- read.csv("Datasets/real_estate.csv") %>% tbl_df()
setwd("~/Dropbox/Datathon/SoerenReal/")
clostestBart <- read.csv("../StandardData/closestBartStation.csv")
dim(clostestBart)
clostestBart
real_estate
clostestBart # zip dist stationidx
zip_all <- read.csv("../StandardData/closestBartStation.csv")
zip_all
zip_all
zip_all <- read.csv("../StandardData/ZipCodes_LatLong_CA.csv")
zip_all
zip_all <- read.csv("../StandardData/ZipCodes_LatLong_CA.csv") %>% tbl_df()
zip_all
clostestBart
real_estate
demos #
zip_all
demos
real_estate
demos
real_homes <- read.csv("../StandardData/Zip_Zhvi_AllHomes.csv") %>% tbl_df()
real_perSF <- read.csv("../StandardData/Zip_MedianValuePerSqft_AllHomes.csv") %>% tbl_df()
real_homes
real_perSF
real_homes
demos #
real_estate #
real_perSF
clostestBart
clostestBart %>% tbl_df() # zip dist stationidx
demos #
real_perSF
?join
demos
left_join(clostestBart, demos, by = "zipcode")
clostestBart
clostestBart %>% tbl_df() %>% rename(zipcode = zip) # zip dist stationidx
clostestBart %>% tbl_df() %>% rename(zipcode = zip) # zip dist stationidx
rename(clostestBart %>% tbl_df(), zipcode = zip) # zip dist stationidx
dplyr::rename(clostestBart %>% tbl_df(), zipcode = zip) # zip dist stationidx
clostestBart %>% tbl_df() %>% dplyr::rename(zipcode = zip) # zip dist stationidx
clostestBart <- clostestBart %>% tbl_df() %>% dplyr::rename(zipcode = zip) # zip dist stationidx
clostestBart
left_join(clostestBart, demos, by = "zipcode")
clostestBart
demos
clostestBart
left_join(clostestBart, demos, by = "zipcode")
real_perSF <- read.csv("../StandardData/Zip_MedianValuePerSqft_AllHomes.csv") %>% tbl_df()
real_perSF
setwd("~/Dropbox/Datathon/SoerenReal/")
real_perSF <- read.csv("../StandardData/Zip_MedianValuePerSqft_AllHomes.csv") %>% tbl_df()
real_perSF
real_perSF
left_join(clostestBart, real_perSF, by = "zipcode")
real_perSF
clostestBart
real_perSF
real_perSF <- read.csv("../StandardData/Zip_MedianValuePerSqft_AllHomes.csv") %>% tbl_df() %>% dplyr::rename(zipcode =RegionID)
left_join(clostestBart, real_perSF, by = "zipcode")
real_perSF <- read.csv("../StandardData/Zip_MedianValuePerSqft_AllHomes.csv") %>% tbl_df() %>% dplyr::rename(zipcode =RegionName)
left_join(clostestBart, real_perSF, by = "zipcode")
inner_join(clostestBart, real_perSF, by = "zipcode")
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X1996.06)
inner_join(clostestBart, real_perSF, by = "zipcode")
colnames(real_perSF)
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12)
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12) %>% melt(id = c("dist", "SizeRank"))
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12) %>% melt(id = c("dist", "SizeRank"))
?melt
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("dist", "SizeRank"))
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("dist", "SizeRank")) %>% tbl_df()
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("dist", "SizeRank")) %>% tbl_df() %>% mutate(variable = substr(variable, 2, 100))
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("dist", "SizeRank")) %>% tbl_df() %>% mutate(variable = as.numeric(substr(variable, 2, 100)))
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
rename(time = variable)
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable)
inner_join(clostestBart, real_perSF, by = "zipcode")
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable) %>%
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable)
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable) %>%
ggplot(aes(x = time, y = value, group = zipcode)) +
geom_line()
clostestBart
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable) %>%
ggplot(aes(x = time, y = value, group = zipcode, color = factor(dist <2))) +
geom_line()
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable) %>%
ggplot(aes(x = time, y = value, group = zipcode, color = factor(dist <2))) +
geom_line(alpha = .3)
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable)
real_perSF
demo_US <- read.csv("../StandardData/demographics_2015_US.csv")
save(file = "demo_US.dts", demo_US)
left_join(clostestBart, demo_US, by = "zipcode")
demo_US
demo_US %>% tbl_df()
demo_US <- demo_US %>% tbl_df()
demo_US
left_join(clostestBart, demo_US, by = "zipcode")
demo_US
left_join(clostestBart, demo_US %>% rename(zipcode = Geo_FIPS), by = "zipcode")
left_join(clostestBart, demo_US %>% dplyr::rename(zipcode = Geo_FIPS), by = "zipcode")
inner_join(clostestBart, demo_US %>% dplyr::rename(zipcode = Geo_FIPS), by = "zipcode")
left_join(clostestBart, demo_US %>% dplyr::rename(zipcode = Geo_FIPS), by = "zipcode")
demo_US
demo_US[1:3, ]
demo_US[1:3, ] %>% as.data.frame()
left_join(clostestBart, demo_US %>% dplyr::rename(zipcode = ZCTA5), by = "zipcode")
demo_US
left_join(clostestBart, demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5), by = "zipcode")
inner_join(clostestBart, demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5), by = "zipcode")
inner_join(clostestBart, demos, by = "zipcode")
clostestBart_inner_demos <- inner_join(clostestBart, demos, by = "zipcode")
clostestBart_demos <- inner_join(clostestBart, demos, by = "zipcode")
real_perSF
inner_join(clostestBart_demos, real_perSF, by = "zipcode")
clostestBart_demos
clostestBart_demos_real_perSF <- inner_join(clostestBart_demos, real_perSF, by = "zipcode")
clostestBart_demos_real_perSF
demos
demo_US <- read.csv("../StandardData/demographics_2015_US_smallSet.csv")
demo_US <- demo_US %>% tbl_df()
demo_US
demos
demo_US %>% dplyr::rename(zipcode = GEO_ZCTA5)
demo_US
demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5)
demos
demos
demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5) %>% filter(zip ==94014)
demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5) %>% filter(zipcode ==94014)
demos
demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5) %>% filter(zipcode ==94030)
clostestBart_demos_real_perSF
demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5) %>% filter(zipcode ==94014)
demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5) %>% filter(zipcode ==94014) %>% as.numeric()
demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5) %>% filter(zipcode ==94014)
demo_US %>% dplyr::rename(zipcode = Geo_ZCTA5) %>% filter(zipcode ==94014) %>% as.data.frame() %>% as.numeric()
setwd("/Users/soeren/Dropbox/Datathon/PlaningAndPresentation/")
clostestBart_demos <- inner_join(clostestBart, demos, by = "zipcode")
clostestBart_demos_real_perSF <- inner_join(clostestBart_demos, real_perSF, by = "zipcode")
clostestBart_demos_real_perSF
clostestBart_demos <- inner_join(clostestBart, demos, by = "zipcode")
real_perSF
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable) %>%
ggplot(aes(x = time, y = value, group = zipcode, color = factor(dist <2))) +
geom_line(alpha = .3)
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable) --> DD
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable) -> DD
D
inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable)
D <- inner_join(clostestBart, real_perSF, by = "zipcode") %>%
select(zipcode, dist, SizeRank, X1996.04:X2016.12) %>% as.data.frame() %>%
melt(id = c("zipcode","dist", "SizeRank")) %>% tbl_df() %>%
mutate(variable = as.numeric(substr(variable, 2, 100))) %>%
dplyr::rename(time = variable)
D
D %>% group_by(dist) %>% summarize(v = mean(value))
D
D %>% group_by(dist) %>% summarize(v = mean(value))
D_acr <- D %>% group_by(dist) %>% summarize(v = mean(value))
lm(v ~ ., data = D_acr)
summary(lm(v ~ ., data = D_acr))
D_acr <- D %>% group_by(dist) %>% summarize(v = ifelse(mean(value) < 1, 1, 0))
summary(lm(v ~ ., data = D_acr))
D_acr
summary(lm(v ~ ., data = D_acr))
D_acr <- D %>% group_by(dist) %>% summarize(v = mean(value))) %>% mutate(dist = ifelse(dist <1, 1,0))
D %>% group_by(dist) %>% summarize(v = mean(value)))
D_acr <- D %>% group_by(dist) %>% summarize(v = mean(value)) %>% mutate(dist = ifelse(dist <1, 1,0))
summary(lm(v ~ ., data = D_acr))
read.csv("../StandardData/DemographicAndRealEstate.csv")
all <- read.csv("../StandardData/DemographicAndRealEstate.csv")
all
all <- read.csv("../StandardData/DemographicAndRealEstate.csv") %>% tbl_df()
all
table(all$pricesft)
all %>% filter(!is.na(pricesft) & is.na(dist))
all
all %>% filter(!is.na(pricesft) & !is.na(dist))
all_inner <- all %>% filter(!is.na(pricesft) & !is.na(dist))
lm(pricesft ~ dist)
lm(pricesft ~ dist, data = all_inner)
summar(lm(pricesft ~ dist, data = all_inner))
summary(lm(pricesft ~ dist, data = all_inner))
summary(lm(pricesft ~ D, data = all_inner %>% mutate(D = ifelse(dist < 1)))
)
all_inner %>% mutate(D = ifelse(dist < 1)))
all_inner %>% mutate(D = ifelse(dist < 1))
summary(lm(pricesft ~ D, data = all_inner %>% mutate(D = ifelse(dist < 1, 1, 0))))
summary(lm(pricesft ~ D, data = all_inner %>% mutate(D = ifelse(dist < 1.1, 1, 0))))
summary(lm(pricesft ~ D, data = all_inner %>% mutate(D = ifelse(dist < .9, 1, 0))))
summary(lm(pricesft ~ D, data = all_inner %>% mutate(D = ifelse(dist < 1, 1, 0))))
summary(lm(v ~ ., data = D_acr))
lm(v ~ ., data = D_acr)
summary(lm(log(v) ~ ., data = D_acr))
lm(log(v) ~ ., data = D_acr)
summary(lm(v ~ ., data = D_acr))
lm(v ~ ., data = D_acr)
summary(lm(v ~ ., data = D_acr))
77 + 50
77 - 50
77 + 50
77.68 - 2 * 28.37
77.68 + 2 * 28.37
all <- read.csv("../StandardData/DemographicAndRealEstate.csv") %>% tbl_df()
table(all$pricesft)
all_inner <- all %>% filter(!is.na(pricesft) & !is.na(dist))
summary(lm(pricesft ~ D, data = all_inner %>% mutate(D = ifelse(dist < 1, 1, 0))))
all_inner
summary(lm(pricesft ~ ., data = all_inner %>% mutate(D = ifelse(dist < 1, 1, 0))))
library(glmnet)
?glmnet
library(randomForest)
library(ranger)
all_pricesft <- all %>% filter(!is.na(pricesft))
all_pricesft
? randomForest
all_pricesft <- all %>% filter(!is.na(pricesft))
randomForest(pricesft ~ ., data data = all_pricesft)
randomForest(pricesft ~ ., data= all_pricesft)
randomForest(pricesft ~ ., data = all_pricesft %>% as.data.frame())
rf_baseline <- randomForest(pricesft ~ ., data = all_pricesft %>% as.data.frame())
all %>% filter(!is.na(pricesft))
all %>% filter(!is.na(pricesft)) %>% select(-zip)
all_pricesft <- all %>% filter(!is.na(pricesft)) %>% select(-zip, - CountyName), - dist, - stationidx)
all_pricesft <- all %>% filter(!is.na(pricesft)) %>% select(-zip, - CountyName, - dist, - stationidx)
all_inner <- all %>% filter(!is.na(pricesft) & !is.na(dist)) %>% filter(!is.na(pricesft)) %>% select(-zip, - CountyName, - dist, - stationidx)
summary(lm(pricesft ~ ., data = all_inner %>% mutate(D = ifelse(dist < 1, 1, 0))))
all_inner
all_inner <- all %>% filter(!is.na(pricesft) & !is.na(dist)) %>% filter(!is.na(pricesft)) %>% select(-zip, - CountyName, - dist, - stationidx)%>% mutate(D = ifelse(dist < 1, 1, 0)) %>% select(-dist)
all
all %>% filter(!is.na(pricesft) & !is.na(dist))
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>% select(-zip, - CountyName, - dist, - stationidx)%>% mutate(D = ifelse(dist < 1, 1, 0)) %>% select(-dist)
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>%
select(-zip, - CountyName, - dist, - stationidx)
all_inner <-
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>%
select(-zip, - CountyName, - dist, - stationidx) %>%
mutate(D = ifelse(dist < 1, 1, 0)) %>% select(-dist)
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>%
select(-zip, - CountyName, - dist, - stationidx) %>%
mutate(D = ifelse(dist < 1, 1, 0))
all_inner <-
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>%
select(-zip, - CountyName, - stationidx) %>%
mutate(D = ifelse(dist < 1, 1, 0)) %>% select(-dist)
summary(lm(pricesft ~ ., data = all_inner %>% mutate(D = ifelse(dist < 1, 1, 0))))
all_inner <-
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>%
select(-zip, - CountyName, - stationidx) %>%
mutate(D = ifelse(dist < 1, 1, 0)) %>% select(-dist)
summary(lm(pricesft ~ ., data = all_inner %>% mutate(D = ifelse(dist < 1, 1, 0))))
summary(lm(pricesft ~ ., data = all_inner))
all_inner
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>%
select(-zip, - CountyName, - stationidx, - City) %>%
all_inner <-
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>%
select(-zip, - CountyName, - stationidx, - City) %>%
mutate(D = ifelse(dist < 1, 1, 0)) %>% select(-dist)
summary(lm(pricesft ~ ., data = all_inner))
summary(lm(pricesft ~ . - white, data = all_inner))
summary(lm(pricesft ~ . - white - medhhincome, data = all_inner))
summary(lm(pricesft ~ . - white - medhhincome - asian, data = all_inner))
summary(lm(pricesft ~ . - white - medhhincome - asian - college, data = all_inner))
66.45 - 2 * 36.46
66.45 + 2 * 36.46
all_inner
library(randomForest)
library(ranger)
all_pricesft <- all %>% filter(!is.na(pricesft)) %>% select(-zip, - CountyName, - dist, - stationidx)
all_pricesft <-
all %>%
filter(!is.na(pricesft)) %>%
select(-zip, - CountyName, - stationidx, - City) %>%
mutate(D = ifelse(dist < 1, 1, 0)) %>% select(-dist)
rf_baseline <- randomForest(pricesft ~ ., data = all_pricesft %>% as.data.frame())
all_pricesft
all_pricesft <-
all %>%
filter(!is.na(pricesft)) %>%
select(-zip, - CountyName, - stationidx, - City)
rf_baseline <- randomForest(pricesft ~ ., data = all_pricesft %>% as.data.frame())
all_pricesft
all_pricesft <-
all %>%
filter(!is.na(pricesft)) %>%
select(-zip, - CountyName, - stationidx, - City, -dist)
rf_baseline <- randomForest(pricesft ~ ., data = all_pricesft %>% as.data.frame())
all_pricesft
table(is.na(all_pricesft$white))
all_pricesft <-
all %>%
filter(!is.na(pricesft), ! is.na(all_pricesft$white)) %>%
select(-zip, - CountyName, - stationidx, - City, -dist)
all_pricesft <-
all %>%
filter(!is.na(pricesft) & ! is.na(all_pricesft$white)) %>%
select(-zip, - CountyName, - stationidx, - City, -dist)
all_pricesft <-
all %>%
filter(!is.na(pricesft) & !is.na(white)) %>%
select(-zip, - CountyName, - stationidx, - City, -dist)
rf_baseline <- randomForest(pricesft ~ ., data = all_pricesft %>% as.data.frame())
table(is.na(all_pricesft$black))
all_pricesft
table(is.na(all_pricesft$medhhincome))
all_pricesft <-
all %>%
filter(!is.na(pricesft) & !is.na(white) & !is.na(medhhincome)) %>%
select(-zip, - CountyName, - stationidx, - City, -dist)
table(is.na(all_pricesft$medhhincome))
rf_baseline <- randomForest(pricesft ~ ., data = all_pricesft %>% as.data.frame())
rf_baseline
rf_baseline$predicted
see <- all %>%
filter(!is.na(pricesft) & !is.na(white) & !is.na(medhhincome))
rf_baseline$predicted[is.na(see$dist)]
rf_baseline$predicted[!is.na(see$dist)]
length(rf_baseline$predicted[!is.na(see$dist)])
all_inner
fitted_price <- rf_baseline$predicted[!is.na(see$dist)]
cbind(all_inner$pricesft, fitted_price)
plot(all_inner$pricesft, fitted_price)
all_inn <- all_inner
all_inn$pricesft <- all_inner$pricesft - fitted_price
summary(lm(pricesft ~ D, data = all_inner))
summary(lm(pricesft ~ dist, data = all_inner))
all_inner <-
all %>% filter(!is.na(pricesft) & !is.na(dist)) %>%
select(-zip, - CountyName, - stationidx, - City) %>%
mutate(D = ifelse(dist < 1, 1, 0))
summary(lm(pricesft ~ dist, data = all_inner))
summary(lm(pricesft ~ D, data = all_inner))
87.63 - 51.87
87.63 +51.87
?sample
sample(1, 3, replace = FALSE)
sample(1, 3, replace = FALSE)
sample(1:3, 3, replace = FALSE)
sample(3, 3, replace = FALSE)
library(randomForest)
library(ranger)
library(ggplot2)
library(dplyr)
################################################################################
## Test 1: run each method several times and check that the MSE distribution is
## the same:
## test data:
iris$Species <- as.numeric(iris$Species)
set.seed(1312)
tetr <- sample(c('test', 'train'), size = nrow(iris), replace = TRUE)
iris_test <- iris[tetr == 'test', ]
iris_train <- iris[tetr == 'train', ]
nsim <- 1000
MSE_brei <- numeric(nsim)
MSE_ranger <- numeric(nsim)
MSE_my <- numeric(nsim)
setwd("~/Dropbox/CATE/CausalRF/")
source("hRF2//hTree.R")
source("hRF2/hTree.R")
source("hRF2/hRandomForest.R")
